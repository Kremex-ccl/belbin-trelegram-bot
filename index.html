<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ë–µ–ª–±–∏–Ω–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }
        .screen { display: none; }
        .screen.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        h1 { color: #333; text-align: center; margin-bottom: 20px; }
        .question { margin: 25px 0; }
        .options { margin: 20px 0; }
        .option {
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .option:hover { border-color: #667eea; background: #f8f9ff; }
        .option.selected { border-color: #4caf50; background: #e8f5e9; }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            margin-top: 20px;
        }
        
        .result-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        
        .progress {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: #4caf50;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
        <div id="welcome" class="screen active">
            <h1>üß© –¢–µ—Å—Ç –ë–µ–ª–±–∏–Ω–∞</h1>
            <p>–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–∞—à–∏ –∫–æ–º–∞–Ω–¥–Ω—ã–µ —Ä–æ–ª–∏ –∑–∞ 5 –º–∏–Ω—É—Ç!</p>
            <div style="margin: 30px 0;">
                <p>üìä <b>–û–ø—Ä–µ–¥–µ–ª–∏—Ç 9 —Ä–æ–ª–µ–π:</b></p>
                <p>‚Ä¢ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å ‚Ä¢ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä ‚Ä¢ –ú–æ—Ç–∏–≤–∞—Ç–æ—Ä</p>
                <p>‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä ‚Ä¢ –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å ‚Ä¢ –û—Ü–µ–Ω—â–∏–∫</p>
                <p>‚Ä¢ –î–∏–ø–ª–æ–º–∞—Ç ‚Ä¢ –ó–∞–≤–µ—Ä—à–∞—é—â–∏–π ‚Ä¢ –°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç</p>
            </div>
            <button onclick="startTest()">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —Ç–µ—Å—Ç–∞ -->
        <div id="test" class="screen">
            <div class="progress">
                <div id="progressBar" class="progress-bar" style="width: 0%"></div>
            </div>
            <div id="questionContainer"></div>
            <div id="optionsContainer" class="options"></div>
            <button id="nextBtn" onclick="nextQuestion()">–î–∞–ª–µ–µ</button>
        </div>
        
        <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
        <div id="results" class="screen">
            <h1>üéØ –í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h1>
            <div id="resultsContainer"></div>
            <button onclick="sendToTelegram()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>
            <button onclick="location.reload()" style="background: #6c757d; margin-top: 10px;">üîÑ –ü—Ä–æ–π—Ç–∏ –µ—â–µ —Ä–∞–∑</button>
        </div>
    </div>

    <script>
        // –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç (7 –≤–æ–ø—Ä–æ—Å–æ–≤)
        const questions = [
            {
                text: "–í –∫–æ–º–∞–Ω–¥–µ —è –æ–±—ã—á–Ω–æ:",
                options: [
                    {text: "–ì–µ–Ω–µ—Ä–∏—Ä—É—é –∏–¥–µ–∏", roles: {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": 2}},
{text: "–û—Ä–≥–∞–Ω–∏–∑—É—é —Ä–∞–±–æ—Ç—É", roles: {"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä": 2}},
                    {text: "–í—ã–ø–æ–ª–Ω—è—é –∑–∞–¥–∞—á–∏", roles: {"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": 2}},
                    {text: "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ä–µ—à–µ–Ω–∏—è", roles: {"–û—Ü–µ–Ω—â–∏–∫": 2}}
                ]
            },
            {
                text: "–ú–æ—è —Å–∏–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞:",
                options: [
                    {text: "–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥", roles: {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": 2}},
                    {text: "–õ–∏–¥–µ—Ä—Å–∫–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞", roles: {"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä": 2}},
                    {text: "–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å", roles: {"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": 2}},
                    {text: "–í–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º", roles: {"–ó–∞–≤–µ—Ä—à–∞—é—â–∏–π": 2}}
                ]
            },
            {
                text: "–í –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —è:",
                options: [
                    {text: "–ò—â—É –∫–æ–º–ø—Ä–æ–º–∏—Å—Å", roles: {"–î–∏–ø–ª–æ–º–∞—Ç": 2}},
                    {text: "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –ø—Ä–∏—á–∏–Ω—ã", roles: {"–û—Ü–µ–Ω—â–∏–∫": 2}},
                    {text: "–ü—Ä–µ–¥–ª–∞–≥–∞—é —Ä–µ—à–µ–Ω–∏–µ", roles: {"–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä": 2}},
                    {text: "–°–æ—Ö—Ä–∞–Ω—è—é —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ", roles: {"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": 2}}
                ]
            },
            {
                text: "–õ—É—á—à–µ –≤—Å–µ–≥–æ —è —É–º–µ—é:",
                options: [
                    {text: "–í–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö", roles: {"–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä": 2}},
                    {text: "–ù–∞—Ö–æ–¥–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã", roles: {"–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": 2}},
                    {text: "–ì–ª—É–±–æ–∫–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–º–µ", roles: {"–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 2}},
                    {text: "–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ", roles: {"–ó–∞–≤–µ—Ä—à–∞—é—â–∏–π": 2}}
                ]
            },
            {
                text: "–ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π:",
                options: [
                    {text: "–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã", roles: {"–û—Ü–µ–Ω—â–∏–∫": 2}},
                    {text: "–î–æ–≤–µ—Ä—è—é –∏–Ω—Ç—É–∏—Ü–∏–∏", roles: {"–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": 2}},
                    {text: "–ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É—é—Å—å —Å –∫–æ–º–∞–Ω–¥–æ–π", roles: {"–î–∏–ø–ª–æ–º–∞—Ç": 2}},
                    {text: "–°–ª–µ–∂—É –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º", roles: {"–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": 2}}
                ]
            },
            {
                text: "–î–ª—è –º–µ–Ω—è –≤–∞–∂–Ω–æ:",
                options: [
                    {text: "–ò–Ω–Ω–æ–≤–∞—Ü–∏–∏ –∏ –Ω–æ–≤–∏–∑–Ω–∞", roles: {"–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": 2}},
                    {text: "–ì–∞—Ä–º–æ–Ω–∏—è –≤ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–µ", roles: {"–î–∏–ø–ª–æ–º–∞—Ç": 2}},
                    {text: "–†–µ–∑—É–ª—å—Ç–∞—Ç –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å", roles: {"–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä": 2}},
                    {text: "–ü—Ä–æ—Ü–µ—Å—Å –∏ –ø–æ—Ä—è–¥–æ–∫", roles: {"–ó–∞–≤–µ—Ä—à–∞—é—â–∏–π": 2}}
                ]
            },
            {
                text: "–í –Ω–µ–∑–Ω–∞–∫–æ–º–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏:",
                options: [
                    {text: "–ò–∑—É—á–∞—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é", roles: {"–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 2}},
                    {text: "–ò—â—É –ø–æ–¥–¥–µ—Ä–∂–∫—É", roles: {"–î–∏–ø–ª–æ–º–∞—Ç": 2}},
                    {text: "–î–µ–π—Å—Ç–≤—É—é —Ä–µ—à–∏—Ç–µ–ª—å–Ω–æ", roles: {"–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä": 2}},
                    {text: "–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ä–∏—Å–∫–∏", roles: {"–û—Ü–µ–Ω—â–∏–∫": 2}}
                ]
            }
        ];

        const roleDescriptions = {
            "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": "–ù–∞–¥–µ–∂–Ω—ã–π –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π. –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –∏–¥–µ–∏ –≤ –¥–µ–π—Å—Ç–≤–∏—è.",
            "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä": "–õ–∏–¥–µ—Ä –∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä. –ù–∞–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –∫ —Ü–µ–ª–∏.",
            "–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä": "–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π –∏ –¥–∏–Ω–∞–º–∏—á–Ω—ã–π. –ü—Ä–µ–æ–¥–æ–ª–µ–≤–∞–µ—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è.",
            "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": "–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π –∏ –∏–Ω–Ω–æ–≤–∞—Ü–∏–æ–Ω–Ω—ã–π. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–¥–µ–∏.",
            "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": "–ö–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω—ã–π. –ò—â–µ—Ç –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.",
            "–û—Ü–µ–Ω—â–∏–∫": "–ê–Ω–∞–ª–∏—Ç–∏–∫. –í–∑–≤–µ—à–∏–≤–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏.",
            "–î–∏–ø–ª–æ–º–∞—Ç": "–ß—É—Ç–∫–∏–π –∏ –¥–∏–ø–ª–æ–º–∞—Ç–∏—á–Ω—ã–π. –°–æ–∑–¥–∞–µ—Ç –≥–∞—Ä–º–æ–Ω–∏—é.",
            "–ó–∞–≤–µ—Ä—à–∞—é—â–∏–π": "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–π –∫ –¥–µ—Ç–∞–ª—è–º. –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ.",
            "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": "–≠–∫—Å–ø–µ—Ä—Ç. –û–±–ª–∞–¥–∞–µ—Ç –≥–ª—É–±–æ–∫–∏–º–∏ –∑–Ω–∞–Ω–∏—è–º–∏."
        };

        let currentQuestion = 0;
        let answers = [];
        let scores = {
            "–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å": 0, "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä": 0, "–ú–æ—Ç–∏–≤–∞—Ç–æ—Ä": 0,
            "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä": 0, "–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å": 0, "–û—Ü–µ–Ω—â–∏–∫": 0,
            "–î–∏–ø–ª–æ–º–∞—Ç": 0, "–ó–∞–≤–µ—Ä—à–∞—é—â–∏–π": 0, "–°–ø–µ—Ü–∏–∞–ª–∏—Å—Ç": 0
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        function startTest() {
            document.getElementById('welcome').classList.remove('active');
            document.getElementById('test').classList.
add('active');
            showQuestion(0);
        }

        function showQuestion(index) {
            const q = questions[index];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = ${progress}%;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å
            document.getElementById('questionContainer').innerHTML = `
                <div class="question">
                    <h3>–í–æ–ø—Ä–æ—Å ${index + 1} –∏–∑ ${questions.length}</h3>
                    <p>${q.text}</p>
                </div>
            `;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            q.options.forEach((option, i) => {
                const div = document.createElement('div');
                div.className = 'option' + (answers[index] === i ? ' selected' : '');
                div.textContent = option.text;
                div.onclick = () => selectAnswer(index, i);
                optionsContainer.appendChild(div);
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById('nextBtn').textContent = 
                index === questions.length - 1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç' : '–î–∞–ª–µ–µ';
        }

        function selectAnswer(qIndex, aIndex) {
            answers[qIndex] = aIndex;
            showQuestion(qIndex);
        }

        function nextQuestion() {
            if (answers[currentQuestion] === undefined) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞');
                return;
            }
            
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                calculateResults();
            }
        }

        function calculateResults() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç
            for (let role in scores) scores[role] = 0;
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –±–∞–ª–ª—ã
            answers.forEach((answerIndex, qIndex) => {
                if (answerIndex !== undefined) {
                    const option = questions[qIndex].options[answerIndex];
                    for (let role in option.roles) {
                        if (scores[role] !== undefined) {
                            scores[role] += option.roles[role];
                        }
                    }
                }
            });
            
            showResults();
        }

        function showResults() {
            document.getElementById('test').classList.remove('active');
            document.getElementById('results').classList.add('active');
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const sortedResults = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            const resultsHTML = sortedResults.map(([role, score], index) => {
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                return `
                    <div class="result-item">
                        <h3>${medals[index]} ${role} (${score} –±–∞–ª–ª–æ–≤)</h3>
                        <p>${roleDescriptions[role]}</p>
                    </div>
                `;
            }).join('');
            
            document.getElementById('resultsContainer').innerHTML = resultsHTML;
        }

        function sendToTelegram() {
            // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
            const sortedResults = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            let resultText = "üéØ *–ú–æ–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞ –ë–µ–ª–±–∏–Ω–∞:*\n\n";
            
            sortedResults.forEach(([role, score], index) => {
                resultText += ${index + 1}. *${role}* - ${score} –±–∞–ª–ª–æ–≤\n;
                resultText += ${roleDescriptions[role]}\n\n;
            });
            
            resultText += "üß© –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç: https://–≤–∞—à-–Ω–∏–∫.github.
io/belbin-telegram-bot/";
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram
            tg.sendData(JSON.stringify({
                action: "test_results",
                results: scores,
                text: resultText
            }));
        }
    </script>
</body>
</html>
